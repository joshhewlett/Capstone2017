<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <title>Testing index</title>
</head>

<body>

    <div>
        <h2>Presentation endpoints</h2>

        <p>
            Get user's presentations
            <a href="/presentation/">
                <button>GET /presentation</button>
            </a>
        </p>

        <p>
            <form method="POST" action='/presentation'>
                Create a new presentation:

                <input id="createPresentation_name" name="name" type="text" placeholder="name">
                <input id="createPresentation_desc" name="description" type="text" placeholder="description">
                <input type="submit" value="POST /presentation">
            </form>
        </p>


        <p>
            Get a presentation by id:
            <input id="getPresentationById_id" type="text" placeholder="id">
            <button onclick="getPresentationById();">GET /presentation/:id</button>
        </p>

        <p>
            Get all slides for a presentation:
            <input id="getPresentationSlides_id" type="text" placeholder="id">
            <button onclick="getPresentationSlides();">GET /presentation/:id/slides</button>
        </p>

        <p>
            Update a presentation:
            <input id="updatePresentation_id" type="text" placeholder="id">
            <input id="updatePresentation_name" type="text" placeholder="name">
            <input id="updatePresentation_desc" type="text" placeholder="description">
            <button onclick="updatePresentation();">PUT /presentation/:id</button>

        </p>

        <p>
            Delete a presentation:
            <input id="deletePresentation_id" type="text" placeholder="id">
            <button onclick="deletePresentation();">DELETE /presentation/:id</button>
        </p>

        <p>
            Get all data for a presentation:
            <input id="getPresentationData_id" type="text" placeholder="id">
            <button onclick="getPresentationData();">GET /presentation/:id/all</button>
        </p>

    </div>
    <br>


    <!-- SLIDES ENDPOINTS -->

    <div>
        <h2>Slides endpoints</h2>

        <p>
            <form method="POST" action='/slide'>
                Create a new slide:

                <input id="createSlide_name" name="presentation_id" type="text" placeholder="presentation id">
                <input type="submit" value="POST /slide">
            </form>
        </p>

        <p>
            Get a slide by id:
            <input id="getSlideById_id" type="text" placeholder="id">
            <button onclick="getSlideById();">GET /slide/:id</button>
        </p>

        <p>
            Get all models belonging to a slide:
            <input id="getSlideModels_id" type="text" placeholder="id">
            <button onclick="getSlideModels();">GET /slide/:id/models</button>
        </p>

        <p>
            Update a presentation: (Endpoint unavailable)
            <!-- <input id="updateSlide_id" type="text" placeholder="id">
            <input id="updateSlide_name" type="text" placeholder="name">
            <input id="updateSlide_desc" type="text" placeholder="description"> -->
            <!-- <button onclick="updateSlide();">PUT /slide/:id</button> -->
        </p>

        <p>
            Delete a slide:
            <input id="deleteSlide_id" type="text" placeholder="id">
            <button onclick="deleteSlide();">DELETE /slide/:id</button>
        </p>
    </div>

    <br>
    <div id="model_endponts">
        <h2>Models endpoints</h2>
        <p>
            Create a new model:

            <input id="createModel_slideId" name="slide_id" type="number" style="width: 30px;" placeholder="slide id">
            <input id="createModel_polyId" name="poly_id" type="text" style="width: 100px;" placeholder="poly id">

            <br>
            <p>
                <span>Position:&nbsp;</span>
                <input id="createModel_transform_posX" type="text" style="width: 30px;" placeholder="X pos">
                <input id="createModel_transform_posY" type="text" style="width: 30px;" placeholder="Y pos">
                <input id="createModel_transform_posZ" type="text" style="width: 30px;" placeholder="Z pos">

                <span>&nbsp;&nbsp;Rotation:&nbsp;</span>
                <input id="createModel_transform_rotX" type="text" style="width: 30px;" placeholder="X rot">
                <input id="createModel_transform_rotY" type="text" style="width: 30px;" placeholder="Y rot">
                <input id="createModel_transform_rotZ" type="text" style="width: 30px;" placeholder="Z rot">

                <span>&nbsp;&nbsp;Scale:&nbsp;</span>
                <input id="createModel_transform_scale" type="text" style="width: 30px;" placeholder="Scale">
            </p>


            <button onclick="createModel();">POST /model</button>

        </p>

        <p>
            Get a model by id:
            <input id="getModelById_id" type="text" placeholder="id">
            <button onclick="getModelById();">GET /model/:id</button>
        </p>

        <p>
            Delete a model by id:
            <input id="deleteModelById_id" type="text" placeholder="id">
            <button onclick="deleteModelById();">DELETE /model/:id</button>
        </p>
    </div>

    <script>
    //
    // ===== PRESENTATION FUNCTIONS =====
    //
    function getPresentationById() {
        window.location = '/presentation/' + document.getElementById("getPresentationById_id").value;
    }

    function getPresentationSlides() {
        window.location = '/presentation/' + document.getElementById("getPresentationSlides_id").value + '/slides';
    }

    function getPresentationData() {
        window.location = '/presentation/' + document.getElementById("getPresentationData_id").value + '/all';
    }

    function updatePresentation() {
        let id = document.getElementById("updatePresentation_id").value;
        let url = '/presentation/' + id;
        let data = {};
        data.name = document.getElementById("updatePresentation_name").value;
        data.description = document.getElementById("updatePresentation_desc").value;

        $.ajax({
            type: "PUT",
            url: url,
            data: data,
            success: function(data) {
                let msg = "{\nid: " + data.id + ",\nname: " + data.name + ",\ndescription: " + data.description + "\n}";
                alert("Data Updated: " + msg);
            }
        });
    }

    function deletePresentation() {
        let id = document.getElementById("deletePresentation_id").value;
        let url = '/presentation/' + id;
        $.ajax({
            type: "DELETE",
            url: url,
            success: function(msg) {
                alert("Data Deleted: " + msg);
            }
        });

    }


    //
    // ===== SLIDE FUNCTIONS =====
    //
    function getSlideById() {
        window.location = '/slide/' + document.getElementById("getSlideById_id").value;
    }

    function getSlideModels() {
        console.log('/slide/' + document.getElementById("getSlideModels_id").value + '/models');

        window.location = '/slide/' + document.getElementById("getSlideModels_id").value + '/models';

    }

    function deleteSlide() {
        let id = document.getElementById("deleteSlide_id").value;
        let url = '/slide/' + id;
        $.ajax({
            type: "DELETE",
            url: url,
            success: function(msg) {
                alert("Data Deleted: " + msg);
            }
        });
    }

    // MODEL FUNCTIONS
    function getModelById() {
        window.location = '/model/' + document.getElementById("getModelById_id").value;
    }

    function createModel() {
        let slide_id = parseInt(document.getElementById("createModel_slideId").value);
        let poly_id = document.getElementById("createModel_polyId").value;

        let position = {};
        position.x = document.getElementById("createModel_transform_posX").value == "" ? 0 : parseInt(document.getElementById("createModel_transform_posX").value);
        position.y = document.getElementById("createModel_transform_posY").value == "" ? 0 : parseInt(document.getElementById("createModel_transform_posY").value);
        position.z = document.getElementById("createModel_transform_posZ").value == "" ? 0 : parseInt(document.getElementById("createModel_transform_posZ").value);

        let rotation = {};
        rotation.x = document.getElementById("createModel_transform_rotX").value == "" ? 0 : parseInt(document.getElementById("createModel_transform_rotX").value);
        rotation.y = document.getElementById("createModel_transform_rotY").value == "" ? 0 : parseInt(document.getElementById("createModel_transform_rotY").value);
        rotation.z = document.getElementById("createModel_transform_rotZ").value == "" ? 0 : parseInt(document.getElementById("createModel_transform_rotZ").value);

        let scale = document.getElementById("createModel_transform_scale").value == "" ? 1 : parseInt(document.getElementById("createModel_transform_scale").value);

        let transform = {
            position,
            rotation,
            scale
        };

        transform = JSON.stringify(transform);

        let data = {
            slide_id,
            poly_id,
            transform
        }

        console.log(data);
        let url = '/model';
        $.ajax({
            type: "POST",
            url: url,
            data: data,
            success: function(msg) {
                msg = JSON.stringify(msg);
                alert("Model created: " + msg);
            }
        });

        console.log("Position X: ", {
            position,
            rotation,
            scale
        });
    }

    function deleteModelById() {
        let id = document.getElementById("deleteModelById_id").value;
        let url = '/model/' + id;
        $.ajax({
            type: "DELETE",
            url: url,
            success: function(msg) {
                alert("Model Deleted: " + msg);
            }
        });
    }

    </script>

</body>

</html>
